# 一、动态规划

想用动态规划解决问题，理论知识必不可少~

## 1.总体思想

- 将待求解的问题分成若干子问题
- 保存已解决子问题的答案，需要的时候找出来用即可

一句话：把大问题分解成若干小问题，并**把小问题的解保存下来**。

## 2.适用场景（基本要素）

所求解的问题满足以下三个性质：

1. **最优子结构性质（前提）**

   - 即待求问题的最优解包含其子问题的最优解。

   - 在分析问题的最优子结构性质时，所用的方法具有普遍性：首先假设由问题的最优解导出的子问题的解不是最优的，然后再设法说明在这个假设下可构造出比原问题最优解更好的解，从而导致矛盾。

   - 利用问题的最优子结构性质，以自底向上的方式递归地从子问题的最优解逐步构造出整个问题的最优解。

2. **重叠子问题**

   - 递归算法求解问题时，每次产生的子问题并不总是新问题，有些子问题被反复计算多次。这种性质称为**子问题的重叠性质**。

   - 动态规划算法，对每一个子问题只解一次，而后将其解保存在一个表格中，当再次需要解此子问题时，只是简单地用常数时间查看一下结果。

   - 通常不同的子问题个数随问题的大小呈多项式增长。因此用动态规划算法只需要多项式时间，从而获得较高的解题效率。

3. **无后效性**

   如果某个阶段的状态已知，问题在此阶段以后的发展仅与该阶段的状态有关，与以前所经历的状态无关。

## 3.解题步骤

1. 找出最优解的性质，并刻划其结构特征。
2. 递归地定义最优值。
3. 以自底向上的方式计算出最优值。
4. 根据计算最优值时得到的信息，构造最优解。

# 二、正则表达式匹配

## 1.题目

> 给你一个字符串 s 和一个字符规律 p，请你来实现一个支持 '.' 和 '*' 的正则表达式匹配。
>
> - `.` 匹配任意单个字符
> - `*` 匹配零个或多个前面的那一个元素
>
> 所谓匹配，是要涵盖整个字符串 s的，而不是部分字符串

```
输入：s = "aab" p = "c*a*b"
输出：true
```

## 2.算法

> **1.找出最优解的性质，并刻划其结构特征。**

首先捋清楚匹配的过程。在进行匹配时：

- 我们每次从`p`中取出`一个字符(如:c、.)`或者`一个字符+一个*(如:c*)`，在`s`中进行匹配。

- `一个字符`可以匹配`s`中的一个字符。
- `字符+*`可以匹配`s`中的任意个字符。

我们的目标是判断`s`是否能与`p`匹配，若能匹配，则`s`的前`i`个字符必定能与`p`的前`j`个字符匹配（**最优子结构**）。

可以考虑动态规划。

------

> **2.递归地定义最优值。（即写出状态转移方程）**

我们首先定义一个二维数组，用来保存子问题的解。（把这个二维数组想象成一张表，动态规划的执行过程说白了就是一个填表的过程）

我们用 `f[i][j]`表示`s`的前 `i`个字符与`p` 中的前`j`个字符是否能够匹配。

接下来分析状态转移。一般地，我们分析`p`的第`j`个字符的匹配情况。有以下三种情况：1) `普通字符`；2) `*`；3) `.`。

- **小写字母**

  如果`p`的第`j`个字符是一个小写字母，那么我们必须在`s`中匹配一个相同的小写字母。

  - 若`s[i]=p[j]`，则`f[i][j]`的值取决于前面的字符串是否能匹配。
  - 若`s[i]!=p[j]`，则无法匹配。

  $$
  f[i][j]=\begin{cases} f[i-1][j-1]， s[i]=p[j]\\ false， s[i]\neq p[j]\end{cases}
  $$

- **\***

  如果`p`的第`j`个字符是`*`，那么代表我们可以对`p`的第`j-1`个字符匹配任意次。有两种情况：

  - `s`的第`i`个字符匹配`p`的第`j-1`个字符，那么还可以继续用`p`的第`j-1`个字符匹配`s`的第`i-1`个字符、第`i-2`个字符......即`f[i][j]`的值取决于`f[i-1][j]`（个人认为，`f[i-1][j] or f[i][j-2]`的意思是其中有一个为true即为true）
  - `s`的第`i`个字符不匹配`p`的第`j-1`个字符，将`p`的第`j-i`个字符与第`j`个字符扔掉，即匹配0次（并没有匹配失败）。

  $$
  f[i][j]=\begin{cases} f[i-1][j]orf[i][j-2]， s[i]=p[j-1]\\ f[i][j-2]， s[i]\neq p[j]\end{cases}
  $$

- **.**

  只要`p`的第`j`个字符是`.`，那么`p[j]`一定成功匹配`s`中任意一个小写字母。

<font color='red'>注：上述公式的`i`，`j`代表**第i个字符**和**第j个字符**，不是字符串的下标</font>

*****

> **3.以自底向上的方式计算出最优值。**(确定开始与结束)

开始位置：`f[0][0]=true`，即两个空字符串是可以匹配的。

结束位置：`f[m][n]`，`m`,`n`分别为字符串`s`和`p`的长度。

*****

> **4.根据计算最优值时得到的信息，构造最优解。**（确定填表顺序）

这道题我们按行填表，即第一重循环遍历`s`的字符，第二重循环遍历`p`的每一个字符，把匹配结果保存在`f[i][j]`中。

## 3.代码

```java
class Solution {
    public boolean isMatch(String s, String p) {
        int m = s.length();
        int n = p.length();

        boolean[][] f = new boolean[m + 1][n + 1];
        f[0][0] = true;
        //i和j代表字符串长度，取字符串下标要对应-1
        for (int i = 0; i <= m; ++i) {
            for (int j = 1; j <= n; ++j) {
                if (p.charAt(j - 1) == '*') {
                    f[i][j] = f[i][j - 2];
                    if (matches(s, p, i, j - 1)) {
                        f[i][j] = f[i][j] || f[i - 1][j];
                    }
                } else {
                    if (matches(s, p, i, j)) {
                        f[i][j] = f[i - 1][j - 1];
                    }
                }
            }
        }
        return f[m][n];
    }

    public boolean matches(String s, String p, int i, int j) {
        //s长度为0时，不管p当前是什么字符，都不匹配
        if (i == 0) {
            return false;
        }
        if (p.charAt(j - 1) == '.') {
            return true;
        }
        return s.charAt(i - 1) == p.charAt(j - 1);
    }
}
```

## 4.举个栗子

```
s = aab
p = c*a*b
```

首先构造空二维数组，以表格形式给出（注意表的行列的含义为字符串`s`和`p`的长度，故初始化时从`0`开始到`length`，即`length+1`）。

初始时，`f[0][0]`为`true`。

|  s\p  |  0   |  1   |  2   |  3   |  4   |  5   |
| :---: | :--: | :--: | :--: | :--: | :--: | :--: |
| **0** | true |      |      |      |      |      |
| **1** |      |      |      |      |      |      |
| **2** |      |      |      |      |      |      |
| **3** |      |      |      |      |      |      |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
    ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
      ↑
(注：j从1开始循环)
s长度为0时，不管p当前是什么字符，都不匹配
```

|  s\p  |  0   |   1   |  2   |  3   |  4   |  5   |
| :---: | :--: | :---: | :--: | :--: | :--: | :--: |
| **0** | true | false |      |      |      |      |
| **1** |      |       |      |      |      |      |
| **2** |      |       |      |      |      |      |
| **3** |      |       |      |      |      |      |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
    ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
        ↑
        
j=2时，对应的字符（p[1]）是*，故f[i][j] = f[i][j - 2] = true,即最少匹配0次，又因为s长度为0，与p[1]不匹配，故最终匹配0次
```

|  s\p  |  0   |   1   |  2   |  3   |  4   |  5   |
| :---: | :--: | :---: | :--: | :--: | :--: | :--: |
| **0** | true | false | true |      |      |      |
| **1** |      |       |      |      |      |      |
| **2** |      |       |      |      |      |      |
| **3** |      |       |      |      |      |      |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
    ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
          ↑

j=3时，由于s长度为0，与p[2]不匹配，f[0][3]=false
```

|  s\p  |  0   |   1   |  2   |   3   |  4   |  5   |
| :---: | :--: | :---: | :--: | :---: | :--: | :--: |
| **0** | true | false | true | false |      |      |
| **1** |      |       |      |       |      |      |
| **2** |      |       |      |       |      |      |
| **3** |      |       |      |       |      |      |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
    ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
            ↑

j=4时，与j=2时类似，f[i][j] = f[i][j - 2] = true
```

|  s\p  |  0   |   1   |  2   |   3   |  4   |  5   |
| :---: | :--: | :---: | :--: | :---: | :--: | :--: |
| **0** | true | false | true | false | true |      |
| **1** |      |       |      |       |      |      |
| **2** |      |       |      |       |      |      |
| **3** |      |       |      |       |      |      |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
    ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
              ↑

j=5时，由于s长度为0，与p[4]不匹配，f[0][4]=false
```

|  s\p  |  0   |   1   |  2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :--: | :---: | :--: | :---: |
| **0** | true | false | true | false | true | false |
| **1** |      |       |      |       |      |       |
| **2** |      |       |      |       |      |       |
| **3** |      |       |      |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
      ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
      ↑

i=1,j=1,不匹配
```

|  s\p  |  0   |   1   |  2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :--: | :---: | :--: | :---: |
| **0** | true | false | true | false | true | false |
| **1** |      | false |      |       |      |       |
| **2** |      |       |      |       |      |       |
| **3** |      |       |      |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
      ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
        ↑

i=1,j=2,由于p对应的当前字符为*，首先f[i][j]=f[i][j-2]，接着判断s[0]与p[0]不匹配，故f[1][2]=f[1][0]=false
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false |       |      |       |
| **2** |      |       |       |       |      |       |
| **3** |      |       |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
      ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
          ↑

i=1,j=3,s[0]=p[2],为true（其实计算这个匹配是冗余的，不过不影响结果）
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  |      |       |
| **2** |      |       |       |       |      |       |
| **3** |      |       |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
      ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
            ↑

i=1,j=4,由于p对应的当前字符为*，首先f[i][j]=f[i][j-2]=false，接着判断s[0]与p[2]匹配，f[i][j] = f[i][j] || f[i - 1][j]（状态转移方程）
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true |       |
| **2** |      |       |       |       |      |       |
| **3** |      |       |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
      ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
              ↑

i=1,j=5,false
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true | false |
| **2** |      |       |       |       |      |       |
| **3** |      |       |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
        ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
      ↑

i=2,j=1,false
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true | false |
| **2** |      | false |       |       |      |       |
| **3** |      |       |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
        ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
        ↑

i=2,j=2,f[i][j]=f[i][j-2]=false
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true | false |
| **2** |      | false | false |       |      |       |
| **3** |      |       |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
        ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
          ↑

i=2,j=3,s[1]=p[2],整体是否匹配取决于前一个状态，f[i][j] = f[i - 1][j - 1]
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true | false |
| **2** |      | false | false | false |      |       |
| **3** |      |       |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
        ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
            ↑

i=2,j=4,首先f[i][j]=f[i][j-2]=false，接着判断s[1]与p[3]匹配，f[i][j] = f[i][j] || f[i - 1][j] = true
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true | false |
| **2** |      | false | false | false | true |       |
| **3** |      |       |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
        ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
              ↑

i=2,j=5,false
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true | false |
| **2** |      | false | false | false | true | false |
| **3** |      |       |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
          ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
      ↑

i=3,j=1,false
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true | false |
| **2** |      | false | false | false | true | false |
| **3** |      | false |       |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
          ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
        ↑

i=3,j=2,f[i][j]=f[i][j-2]=false
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true | false |
| **2** |      | false | false | false | true | false |
| **3** |      | false | false |       |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
          ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
          ↑

i=3,j=3,false
```

|  s\p  |  0   |   1   |   2   |   3   |  4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :--: | :---: |
| **0** | true | false | true  | false | true | false |
| **1** |      | false | false | true  | true | false |
| **2** |      | false | false | false | true | false |
| **3** |      | false | false | false |      |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
          ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
            ↑

i=3,j=4,,f[i][j]=f[i][j-2]=false
```

|  s\p  |  0   |   1   |   2   |   3   |   4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :---: | :---: |
| **0** | true | false | true  | false | true  | false |
| **1** |      | false | false | true  | true  | false |
| **2** |      | false | false | false | true  | false |
| **3** |      | false | false | false | false |       |

*****

```
i : 0 1 2 3（i的含义是s的长度）
s =   a a b
          ↑
    
j : 0 1 2 3 4 5（j的含义是p的长度）
p =   c * a * b
              ↑

i=3,j=5,首先f[i][j]=f[i][j-2]=false，接着f[i][j] = f[i][j] || f[i - 1][j] = true
```

|  s\p  |  0   |   1   |   2   |   3   |   4   |   5   |
| :---: | :--: | :---: | :---: | :---: | :---: | :---: |
| **0** | true | false | true  | false | true  | false |
| **1** |      | false | false | true  | true  | false |
| **2** |      | false | false | false | true  | false |
| **3** |      | false | false | false | false | true  |

*****

最终答案即`f[3][5]=true`